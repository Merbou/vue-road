/*!
 * vue-road v1.0.2
 * (c) Merouane Boucenna
 * Released under the MIT License.
 */
"use strict";function t(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function r(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function n(t,r){if(null==t)return{};var e,n,i=function(t,r){if(null==t)return{};var e,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)e=o[n],r.indexOf(e)>=0||(i[e]=t[e]);return i}(t,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)e=o[n],r.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(i[e]=t[e])}return i}function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,r){if(!t)return;if("string"==typeof t)return o(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return o(t,r)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var u=function(){function r(e){var n=this,i=e.router,o=e.middlewares,u=e.route;t(this,r),o&&u&&(this.middlewares=o,this.route=u,i.beforeEach((function(t,r,e){n.standrad({to:t,from:r,next:e},"before")})),i.afterEach((function(t,r){n.standrad({to:t,from:r},"after")})))}return e(r,[{key:"standrad",value:function(t,r){var e=this,n=t.to,i=t.from,o=t.next;this.route.get().filter((function(t){return t.routes.findIndex((function(t){return t.path===n.path.split("/").slice(0,2).join("/")}))>-1})).flatMap((function(t){return t.middlewares})).forEach((function(t){Object.keys(e.middlewares).indexOf(t)>-1&&e.middlewares[t][r]&&("before"==r?e.middlewares[t][r]({to:n,from:i}).then((function(t){t===n.path?o():t?o(t):o()})).catch((function(t){res===n.path?o():o(t)})):e.middlewares[t][r]({to:n,from:i}))}))}}]),r}(),a=function(){function r(e,n){t(this,r),this.customRouteCase=n,this._rs_mds=[],this.ROUTES=[],e.call(this)}return e(r,[{key:"middleware",value:function(t){var r=t.router,e=t.middlewares;return new u({router:r,middlewares:e,route:this}),this}},{key:"route",value:function(t,r){var e=this.splitMiddleware(r);return this.ROUTES.push({routes:i(t),middlewares:e}),t=this.customRouteCase?this.customRouteCase(t):this.routeCase(t),this._rs_mds.push({routes:t,middlewares:e}),t}},{key:"routeCase",value:function(t){var r=this;return t.map((function(t){var e=t.children,i=n(t,["children"]);return Object.assign({},i,{children:e&&r.routeCase(e)})}))}},{key:"splitMiddleware",value:function(t){try{if(Array.isArray(t))return t;if("string"==typeof t)return t.split(",");throw"middleware not valid"}catch(t){return["init"]}}},{key:"getMiddleswares",value:function(){return i(new Set(this.ROUTES.flatMap((function(t){return t.middlewares}))))}},{key:"constant",value:function(){return this._rs_mds&&this._rs_mds.map((function(t){return t.routes})).flatMap((function(t){return t}))||[]}},{key:"get",value:function(t){return t?(t=Array.isArray(t)?t:[t],this.ROUTES.filter((function(r){return r.middlewares.filter((function(r){return t.indexOf(r)>-1})).length})).flatMap((function(t){return t.routes}))):this.ROUTES}}]),r}();module.exports=a;
//# sourceMappingURL=index.js.map
